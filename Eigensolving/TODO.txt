* get bits of code from Tomas and Laurent
